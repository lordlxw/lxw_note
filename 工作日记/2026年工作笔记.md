# 2026年工作笔记

## 1月

> 1.1
>
> 和老渣他们约在打浦桥那里跨年，其实就是坐着聊聊天，玩玩游戏。
>
> 一点东西都没吃。。。
>
> 12点走出门逛逛，结果捡到一部手机，失主打电话来就还给她了，后面想刮刮乐最终也没找到合适的店铺，
>
> 无疾而终，1点多打的车，2点半才打到，给胖子、巨魔、浩文李都送回去了。
>
> 我骑电瓶车送的老渣。
>
>
> 回家溜完狗睡了一会，大概眯了两个多小时去的火车站
>
> 和小林去南京了，她就穿了两件。身体太好了。
>
> 到南京先去吃了牛肉锅贴，到酒店放了行李眯了一下就去了南京博物院
>
> 瞎逛逛，晚上好像也没啥吃，买了个乌饭团。
>
> 睡觉，和小林睡在一张床上了，什么都没有发生。。。实在太挤了，三点我就回自己床上了。



> 1.2
>
> 一觉醒来过了7点了，去了明孝陵。早上吃了酒店楼下的绿柳居，味道一般般，吃了包子和青团。
>
> 去的还算比较早，人还不多，喂小鹿还是一个蛮不错的项目呢。
>
> 一份草料可以带三个人进去，于是还有一个小女生（目测大学生）跟我们一起进去了，硬转给了我十块。
>
> 后面就是瞎逛逛，跟小林讲解了一下历史啥的。
>
> 前一天正好下雪，很多人在等着房梁上的雪落下来。
>
>
> 中午排队去吃了无名卤面，其实就是大肉面，大肉真的超级大，面的样子是晴喜欢的手擀面，排了20分钟吧，排到了，点了两份大肉面和一份肥肠。



> 1.3
>
> 休息休息
>
> Epic里拿了免费的三国游戏，试玩了一下，不是很会。。



> ==1.4==
>
> telerik里 切换颜色 用 FluentResource
>
> hy跟我说了一下几个提供刷新的方法
>
> ```cmd
> var bindingExpression = BindingOperations.GetBindingExpression(yourControl, YourProperty);
> if (bindingExpression != null)
> {
>  bindingExpression.UpdateSource(); // 更新源属性
>  // 或者
>  // bindingExpression.UpdateTarget(); // 更新目标属性
> }
> ```
>
> hy做事还是很认真的
>
>
> telerik里切换样式，除非指定的颜色，其余可以用转换器实现。
>
> ```cmd
> <Setter TargetName="Bd" Property="Background" Value="{telerik:FluentResource ResourceKey=AccentBrush}" />
> ```
>
>
> 凌晨2点到了感恩护理院，外公似乎快要走到尽头了。
>
> 说实在的，长这么大，还是第一次在病房里实打实地抢救。
>
> 5.05 分，强心剂的作用下，外公突然睁眼了，血压也稳定在70-110左右，血氧有点低 80左右，当时以为能稳住续上一点时间，但似乎还是不太行。浑身浮肿，手和脚已经出现明显尸变了，哎。眼睛突然睁开了（04：35左右），是那种眨眼的，现在看来还是回光返照。
>
> 9.30分，奇迹还是没有发生，一下子就西去了。
>
> 11点赶到病房，护工帮忙穿上寿衣，看最后一眼，没办法，生命就是这么脆弱，护理院的三年时间，已经是元老了，也算落下序幕了，外公，小时候一直和我生活在一起的，爱您。享年实足88。
>
> 1937.11.27——2026.01.04 人生匆匆啊



> 1.5
>
> 把选择设备的那个第三列界面写了一下，就是选择路径，错误展示红边。



> ==1.6==
>
> 请了一天丧假，早上8点出的门，西宝兴路很近，6分钟就到了，苏州的亲戚已经在了。
>
> 签好刀，挂上黑红布，来了一共30人不到，退管会和阿舅分别致悼词。鞠躬仪式过后，外公被推出来，瞻仰过后，阿舅把棺盖敲上三颗钉子，我和妹妹敲了最后一个钉子的一半，这下真盖棺定论了。
>
> 一生就这么结束了。
>
> 之后我举着遗像坐在巴士前面，400m的路，大巴车开得很慢。
>
> 10点多到达吃饭的地方，脚跨过假的火圈，遗像放置在房间里。
>
> 豆腐羹饭味道还不错，第一次尝到了鱼翅。
>
>
> 下午缅怀外公，去跑步了。11.27km，纪念一下诞辰吧。
>
> *真正的*终点不*是死亡*而是*被遗忘*。
>
> 发了pyq 和 wb。
>
> 晚上妈去外婆那里折锡箔了，回来看得出来心情很糟糕，也不知道发生了啥。



> 1.7
>
> 早上还是在测sglang的各个参数
>
>
> 下午hy跟我说了一下新需求
>
> 选channel后，根据Infrasture的值来限制/设置datagrid的值
>
> 还有外面的值
>
> 有点云里雾里的



> 1.8
>
> 早上hy他们开了个会，MicroSnap要做一下新的功能，就是可以支持输入文字
>
> 也要支持保存啥的
>
> 这个感觉难度还是有的。。要用那个DrawingTool做。。感觉先入手一下再看看。
>
> 找到Icon了，Text_Solid



> 1.9
>
> LK500反馈了一个问题，以太网连接两台设备时SN解析有问题
>
> 经查实，是最后一位加密标志位和SN码连在一起了。
>
> 需要单独判断&符号的第一位符号位。
>
> 现在C++做第一层过滤，thorlabs+LK500
>
> 再在C#端做第二层过滤筛选逻辑。



> 1.10
>
> 给外公过头七，在阿舅家举办仪式，烧了很多稀薄，还有个大房子，火烧的很旺，很细，走完了88岁的一生。
>
> 下午给妹妹补课
>
> 补到3点20，立马赶去龙之梦和甜子看电影了。没错，又看了一遍疯狂动物城2。
>
> 晚上吃了哥哥的深夜食堂，还行。



> 1.11
>
> 周末和小林到虹桥逛了一下
>
> 吃了自助！烟火长安，其实就是牛new一个牌子下面的。
>
> 味道还可以。
>
> 吃了55串！感觉自己很强，小林只有23串，弱爆了。



> 1.12
>
> 中午其实就把绘图工具差不多完成了，但tmd换了内存条，cursor给我改掉了。。我还没提交。
>
> nnd下午又重新改了。
>
> 然后hy让我合了下它最新的microsnap分支到我当前修改stageservice的地方，合了蛮久的。。



> 1.13
>
> 我的stageService分支合并后打断点调试一直有问题。会直接break，程序crash。
>
> 改配置啥的都没有用。
>
> 查了半天，后来发现有个IsSupport C#的dll和C++的声明参数不一致，C#2个，C++3个，参数不一致的问题导致的。
>
> 但仔细想一下还是不对。。。hy的分支上也是不一致，但就没有出现这个问题。
>
> 但是还有一个问题是debug.write一直输出不到output目录，这个问题还在查。
>
> 终于找到问题了。。。所以导致永远只能连第一个设备的。多设备情况下就会出错。
>
> ```cmd
> int32_t Open_Ethernet(const char* sn_ip, const char* key, int32_t timeout_millisecond)
> {
> 	int id = 0;
> 	bool found = false;
> 	if (!s_ethernet_Listed)
> 	{
> 		int len = 10240;
> 		char* buffer = new char[len] {0};
> 		List_Ethernet(nullptr, nullptr, buffer, len);
> 		delete[] buffer;
> 	}
> 
> 	for (int i = 0; i < s_ethernet_devices_listed.size(); i++)
> 	{
> 		if (strcmp(sn_ip, s_ethernet_devices_listed[id].SN) == 0 || strcmp(sn_ip, s_ethernet_devices_listed[id].IP) == 0)
> 		{
> 			found = true;
> 			id = i;
> 			break;
> 		}
> 	}
> 	
> 	//这里不应该传id应该传i啊！！！
> ```
>
> 周报的时候可以这么写：
>
> 1、一个是list_ethernet的问题。list同种设备没有逗号分隔符，会导致解析错误。
>
> 2、一个是open的问题。循环的时候出现假循环的情况，导致设备在多个同种设备连接的时候打开不了。





> 1.14
>
> 继续改labelROI控件，修了蛮多的，但是还不够。



> 1.15
>
> hy让jetty看了一些目前我设计的label绘制文字控件，要改的部分还蛮多的。
>
> 1、点一下 给个默认宽度，可以拉伸，但其实是只能拉伸宽度，不能拉伸高度的。 回车是换行。
>
> 这里可以做成如果已经到边角了，则宽度是自适应为 剩余距离-当前距离
>
> 拉伸宽度可以参考rectangle的实现。
>
> 
>
> 周报总结：
>
> 1、LK500方面
>
> 存在多台设备同种方式连接时会出现连接失败的情况，有两个问题
>
> 一个是以太网设备标识符需要通过逗号分隔来区分
>
> 二是代码存在硬编码bug的问题，导致只会连接第一个设备。
>
> 现都修复好了。
>
> 1、Microsnap方面
>
> ①、完成simluator_controller的步长设置、软件限位以及配置界面的UI显示。
>
> ②、label绘制文字的控件做了个雏形，功能基本实现了，但优化的点还蛮多的，在按着设计稿改。
>
>
> 晚上和甜子打了个球，15公里，40分钟就开到了，比我想象的快。
>
> 吃kfc终于把成都的机票和酒店定下来了。



> 1.16
>
> hy提了两个问题：
>
> 1、在移动到绝对位置的时候加上渐进的功能。
>
> 2、看看这个归位的按钮，看看mcm301是怎么实现的。
>
>
> 关于microsnap的自定义label控件
>
> 1、实现拖拽改变宽度并自适应文本变化。
>
> 2、文字随着字体、整体设置进行变化。
>
> 实现了simualator下的长按效果，模拟渐进变化。





> 1.17
>
> 去妹家补课了
>
> 2.30——8点
>
> 蛮长时间的。。。下周就期末考了，希望加点油吧。



> ==1.18==
>
> 和小林在宝山宜家关门前去了最后一次。
>
> 冰淇淋根本不卖了，仍然p都没买hh，不过买了两包丸子尝尝。
>
> 小林在电梯上问我我和她是什么关系，是情侣关系吗？我回答是，因为我觉得她人还是不错的。
>
> 给我看了看她刚毕业时的照片，确实蛮漂亮的。
>
> 希望和她能有个结果吧。
>
> 多多赚钱！！！
>
> 晚上吃了个牛排，当然在宜家也吃了块牛排（预制，，，不过比必胜客好吃）





> 1.19
>
> 参考MCM301的setZero的逻辑
>
> 给MicroSnap也加上了这个相对便宜的逻辑，当home时会自动全部归0。清空relativeDistance。



> 1.20
>
> 修复了microsnap打开mcm301会crash的bug。
>
> microsnap增加了保存/加载人工编辑配置的功能
>
> hy让我对比一下microsnap中drawingtool分支的修改，目前develop是2.1.8，drawingtool修改的时候是2.1.12，但最终肯定是要更新到2.1.18的。
>
> 修复问题，兼容2.1.18 drawingtool版本
>
> 
>
> 对比hy和zw的修改
>
> 1、主要增加了Ratio
>
> 2、OpenWrite改成Create，更安全
>
> 3、ToolProfile增加RefreshCursor功能
>
> 
>
>
> 记录了一下RelativeDisplacement变量，当setZero的时候。
>
> 当setHome的时候清零。
>
> mcm301现在microsnap调用会报错。





> 1.21
>
> 今天是真冷啊。。。电瓶车开过来差点没冻死我。
>
> 衣服很保暖，但是耳朵不行，小林说晚上要吃个饭。
>
> 把mcm301能正常跑在microsnap上了。
>
> 问题出在一个结构体不对，没有及时更新
>
> 调整了一下setZero的代码逻辑，跑着基本没问题。
>
> 
>
> splashwindow增加了UI主题色切换的功能。
>
> 
>
>
> 新的问题是：
>
> 当把drawingTool更新到1.2.18（最新版本）的时候会出现 拖动我的graphicText异常的情况
>
> 还没找到原因，要用源码调试看看，hy说把源码的dll复制过去然后attach过去。





> 1.22
>
> 新的PriorScanII设备有点问题。。排查中
>
> 
>
> 周报内容：
>
> 1、label控件给默认宽度，边界时会自适应宽度。
>
> 2、实现回车换行功能
>
> 3、输出的文字实现fontsize、fontweight、fontStyle的自动变化
>
> 4、实现了simualatorStage下的长按效果，模拟渐进变化。
>
> 5、修复microsnap里mcm301的代码问题
> 参考MCM301的SetZero逻辑 应用在microsnap上，增加保存/加载stage人工编辑配置的逻辑。
>
> 6、更新drawingTool版本到最新版本，修复报错。
> splashwindow增加了UI主题色切换的功能。





> 1.23——1.25
>
> 和甜子、子豪去成都玩了下。
>
> 周四晚上出发的，晚上的飞机是真难熬啊。。坐三个小时感觉人快无了。
>
> 住在熊猫基地旁边，8点入园，排了一个小时左右吧，看花花，其实没啥区别（我自己感觉）还不如小一点的大熊猫可爱。
>
> 下午去了三星堆。全是面具hh，甜子买了巨多文艺饰品我也是服了。
>
> 逛逛就得了，还借了个讲解的，感觉没啥用。
>
> 晚上回春熙路，赶着吃我那个自助，7点30截至下单，7点还没到。。。
>
> 急头白脸干了一顿。。270块。（25的服务费），甜品味道还不错，鸡汤豆花也可以，环境蛮好的，就这样吧。逛了一圈春熙路，感觉也没啥东西，就跟小南京路一样。
>
>
> 周六
>
> 早上去了青城山。地铁+高铁的路线。
>
> 呼吸了下空气吧，道士山。
>
> 青城山分前山和后山，是两个路线，门票也不一样，前山80，后山15。
>
> 前山看人文，后山看风景。
>
> 甜子选了前山，到那甜子上了香，祈福了下，感觉她还蛮信这个的。
>
> 下午去了都江堰，上海的优待还不错，只要15元，请了个人工向导，人工的和机器还是完全不一样的，感觉还蛮值得，介绍了下都江堰得由来，李冰啊，内江和外江啊。都是发源于岷江，岷江又是发源于雪山口什么的，宝瓶口啥的。向导还合了个影，太丑了555。
>
> 晚上吃了个鱼，再去看了下旁边的江。蓝眼泪，其实就是水下埋了灯，水还蛮大的。
>
> 回去10点了，酒店对面就是按脚的，金足印象，折磨了自己一会。
>
> 周日
>
> 准备打道回府了。早上去了宽窄巷子，这个还蛮值得逛逛的，元素蛮丰富的，好利来买了点特产。
>
> 子豪出发前，上飞机前耳机落酒店了 然后去找没找到 把手机又落着了 打车再回去拿
>
> 真是神人。。
>
> 五点回的家，遛狗，还和外婆，大妈妈他们出去吃了。



> 1.26
>
> 复工咯
>
> 带给同事吃点小零食。
>
> 这个procanII硬件感觉有些问题啊。



> 1.27
>
> 1. 绘制层级分离：基类 GraphicROIBase 设计上把“内容显示”（Render，index 1）和“选中/手柄”（Handle，index 2）分开了。
> 2. 默认行为：基类默认认为 IsSelected 变化只需要重绘 Handle 层（为了性能，不重绘内容）。
> 3. 您的实现：您的 GraphicText 比较特殊，把“被选中时的虚线框”画在了 Render 层里。
> 4. 冲突：当 IsSelected 变 true 时，基类只刷新了 Handle 层（您那里是空的），而 Render 层没刷新，所以您写的“如果选中则画虚线框”的代码根本没执行。
>
> 通过 OverrideMetadata 添加那个回调，就是强制告诉系统：“对于 GraphicText 这个类，一旦 IsSelected 变了，顺便把 Render 层也给我刷新一下”。
>
> 这样您的 DrawRender 就会重新运行，检测到 IsSelected == true，然后画出虚线框，您就能看见它被选中了。
>
> 
>
> hy说，如果用joinsitck手柄在外部控制stage，三个轴，界面会怎么样呢
>
> 要避免读到脏数据。
>
> ControllerStageUpdatedEvent —— ControllerStageUpdateEventInfo这个事件
>
> ---
>
> 在测试bbd设备时，发现device连接上，但是eacomtool打不开的问题。
>
> hy进到devicemanager里帮我打开vcp功能就好了。
>
> **VCP**：
>  👉 *“把 USB 设备伪装成一个串口（COMx）”*
>
> **APT 设备**：
>  👉 *“一套厂商/行业自定义的高速设备通信协议”*
>  👉 不是串口，**是专用 API / SDK / 协议栈**
>
> 
>
>
> 修复了一个openDevice的问题，有空格要trim掉。
>
> ```cmd
> int32_t GeneralControlStage::Open(const char* parameters, int32_t parameterLength)
> {
> 	std::vector<std::string> temp;
> 
> 	SplitString(parameters, temp, ",");
> 	if (temp.size() != 3)
> 	{
> 		return ERR_DEVICE_FAILEDTOPARSESERIALSTRING;
> 	}
> 	std::string serial = temp[0];
> 	std::string product = temp[1];
> 	std::string manufacture = temp[2];
> ```
>
> 





> 1.28
>
> 合了下hy的代码，改动还蛮多的。
>
> simulator那修正了一下
>
> 加了个config save和load的逻辑
>
> PriorScan设备的问题是移动会卡死（硬件方面），BBD则是还没找到可以控制的slot，下周争取能把着两个设备跑通。



> 1.29
>
> 游沐日记 团建咯
>
> 早上9点出的门，9.40到的地点。（离公司2km）
>
> 很巧，电梯的地方碰到了德政和他老婆。
>
> 进去没冲直接上去了，玩了把狼人杀，我是女巫，救了hy，张伟 预言家，两晚都倒了，我毒也没用。以为翻盘无望。结果一波三折，好人还是赢了。3-3-3。
>
> Eason儿子长得是真帅啊。颜值很高hh，想必老婆肯定很漂亮。
>
> 中午午饭，虽然看起来东西很多。。但没啥能吃的感觉。吃了点三文鱼，吃了个汉堡，基本差不多了。
>
> 下午开了个KTV（额外收费的），德政和沈教练唱歌是真不错啊，特别是沈教练的粤语歌，基本跟原唱差不多了。
>
> 我唱的几首都一般般。。。调高的上不去，年纪大了感觉中气不足了。
>
> 下午他们就打打台球，也没开周会，德政三点多就走了。
>
> 我跟博涵开了两把大乱斗，全GG。。。
>
> 最后跟hy，zw泡了个汤。一会就泡的膨胀了。
>
> 6.30回去了。



> 1.30
>
> 1月最后一天工作日了。
>
> 主要做了两件事：
>
> 1、把Device设备相关的warning都修复了。
>
> 2、处理了Stage异常crash的问题，现在有messagebox提示。
>
> hy交代给我的汇报给Eason 关于laser和NI设备的事情没做，Eason也没问。
>
> NI设备这边还是没有调试好。。忘记咋跑了。下周等他回来再说吧。
